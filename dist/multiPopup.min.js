!function(){"use strict";function a(a){var b;this._handlers={},this._windows={},this._windowsHTMLElements=[],this._transition=i,!g(a)&&e(a.key)&&d(a.window)&&this.addWindow(a.key,a.window,a),this._addOverlay(),this.on("showed",function(){this.window.classList.remove(h)}),this._resizeHandler=function(){this.isOpen&&(clearTimeout(b),b=setTimeout(this._showAnimateWin.bind(this),10))}.bind(this),window.addEventListener("resize",this._resizeHandler,!1)}function b(a,b,c){for(var d=a.target,e=b.params.opt_hideButtonCls,f=b.params.opt_handlerClickCls;d!==this.parentNode;){if(d.classList.contains(e))return c.hide();if(d.classList.contains(f))return void c.emit("dataClick",d.getAttribute("data-popup-value"));d=d.parentNode}}function c(a){return d(a)?a.parentNode.removeChild(a):void 0}function d(a){return"object"==typeof a&&1===a.nodeType&&"object"==typeof a.style&&"object"==typeof a.ownerDocument}function e(a){return"string"==typeof a}function f(a){return"function"==typeof a}function g(a){return void 0===a||null===a||a!=a}var h="popup-window-animate",i={getSupported:function(){var a=this.supportedVal;if(a)return a;var b,c=document.createElement("fakeelement"),d={OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(b in d)if(void 0!==c.style[b])return this.supportedVal=d[b];return void 0!==c.style.transition?this.supportedVal="transitionend":!1},end:function(a,b){var c=this.getSupported();return c?void a.addEventListener(c,function d(){a.removeEventListener(c,d),b()}):(b(),!1)}};a.prototype.addWindow=function(a,c,e){var f,h=this;if(e=e||{},g(e.useAnimate)&&(e.useAnimate=!0),g(e.opt_useOverlay)&&(e.opt_useOverlay=!0),!d(c))throw new TypeError("Incorrect argument 'modalWindow', expected HTMLElement");return f=this._windows[a]={elem:c,params:e,_handlers:{onClick:function(a){b.call(c,a,f,h)}}},this._windowsHTMLElements.push(c),c.addEventListener("click",f._handlers.onClick,!1),c.style.display="none",c.style.position="fixed",c.style.zIndex="100000",this.window||this.setActiveWindow(a),this},a.prototype.removeWindow=function(a,b){if(this._windows[a]){var e,f=this._windows[a].elem;a&&d(f)&&(f===this.window&&this.hide(),f.removeEventListener("click",this._windows[a]._handlers.onClick),b===!0&&c(f),e=this._windowsHTMLElements.indexOf(f),-1!=e&&this._windowsHTMLElements.splice(e,1),delete this._windows[a])}},a.prototype.setActiveWindow=function(a){var b,c,e=this,f=e._windows;if(e.isOpen)return void e.on("hide",function h(){console.log("hide"),e.setActiveWindow(a),e.off("hide",h)});if(!d(a)&&f[a])var b=f[a];else if(d(a)){c=Object.keys(f);for(var g=0;g<c.length;g++)console.log(a,f[c[g]].elem),f[c[g]].elem===a&&(b=f[c[g]])}b&&d(b.elem)&&b.elem!=e.window&&(e.hide(),e._activeWinObject=b,e.window=b.elem)},a.prototype.getWindowParams=function(a){return this._windows[a]?this._windows[a].params:void 0},a.prototype.on=function(a,b,c){if(!this._isDestroyed){if(this._handlers[a]||(this._handlers[a]=[]),!f(b))throw new TypeError("Argument [handler] must be a Function ");return!d(c)&&this._windows[c]&&(c=this._windows[c].elem),d(c)&&-1!=this._windowsHTMLElements.indexOf(c)?void this._handlers[a].push({target:c,handler:b}):void this._handlers[a].push(b)}},a.prototype.off=function(a,b,c){if(!this._isDestroyed){var e=this._handlers[a];if(e){b||delete this._handlers[a],!d(c)&&this._windows[c]&&(c=this._windows[c].elem),d(c)&&-1==this._windowsHTMLElements.indexOf(c)||(c=!1);for(var g=0;g<e.length;g++){if(f(e[g])&&e[g]==b)return void e.splice(g,1);c&&e[g].target===c&&e.splice(g,1)}}}},a.prototype.emit=function(a){var b=this,c=this._handlers[a],d=arguments;c&&setTimeout(function(){b._isDestroyed||c.forEach(function(a){f(a)?a.apply(b,[].slice.call(d,1)):a.target===b.window&&a.handler.apply(b,[].slice.call(d,1))})},0)},a.prototype.VERSION=[2,0,0],a.prototype.setBasicStartPosition=function(){var a=this.window,b=(window.innerWidth-a.offsetWidth)/2;return a.style.top=-a.clientHeight+"px",a.style.left=b+"px",{top:-a.clientHeight,left:b}},a.prototype.setBasicEndPosition=function(){var a=this.window,b=(window.innerHeight-a.offsetHeight)/2,c=(window.innerWidth-a.offsetWidth)/2;return a.style.top=b+"px",a.style.left=c+"px",{top:b,left:c}},a.prototype.show=function(a){if(this.setActiveWindow(a),!this.isOpen&&!this._isDestroyed&&d(this.window)){var b=this.window,c=this._activeWinObject.params;return this.emit("show"),c.opt_useOverlay&&(this.overlay.style.display="block"),b.style.display="block",f(c.setStartWindowPosition)?c.setStartWindowPosition.call(this):this.setBasicStartPosition(),this._showAnimateWin(),!g(i)&&c.useAnimate&&i.getSupported()?i.end(b,function(){this.emit("showed")}.bind(this)):this.emit("showed"),this.isOpen=!0}},a.prototype.hide=function(){return this.isOpen&&!this._isDestroyed&&d(this.window)?(this.overlay.style.display="",this.window.style.display="none",this.isOpen=!1,this.emit("hide"),!0):void 0},a.prototype.destroy=function(a){this._isDestroyed||(this._isDestroyed=!0,Object.keys(this._windows).forEach(function(b){this.removeWindow(b,a)},this),window.removeEventListener("resize",this._resizeHandler),this.overlay.removeEventListener("click",this._hideHandler),delete this._handlers,c(this.overlay),this._transition=this.window=this.overlay=void 0)},a.prototype._showAnimateWin=function(){var a=this._activeWinObject.params;f(a.setEndWindowPosition)?a.setEndWindowPosition.call(this):this.setBasicEndPosition(),a.useAnimate&&!this.isOpen&&this.window.classList.add(h)},a.prototype._addOverlay=function(){var a=document.createElement("div"),b=this;a.className="popup-overlay",this._hideHandler=function(){return b._activeWinObject.params.opt_isOverlayClickHide?b.hide():void 0},a.addEventListener("click",this._hideHandler,!1),this.overlay=document.body.appendChild(a)},window.MultiPopup=a}();